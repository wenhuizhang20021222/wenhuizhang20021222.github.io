---
title: 关系数据库
tags: 
- 数据库
category: 
- 数据库
abbrlink: 19168
date: 2022-06-23 11:20:17
password: 123456
message: 请输入密码查看文章
---

## 1、基本概念

**关系模型的特点：**①结构简单、表达力强；②语言的一体化；③非过程化的操作；④坚实的数学基础（关系理论）

**关系模型的三要素**：

- 关系数据结构：在关系模型中，实体与实体之间的联系均用表来表示
- 关系数据操作：包括增删改查、传统的集合操作、专门的关系操作
- 关系的完整性约束：实体完整性、参照完整性、用户自定义的完整性

<!-- more -->

**关系的基本术语**：

| 基本术语         | 含义                                                         |
| ---------------- | ------------------------------------------------------------ |
| 元组和属性       | 元组：行，属性：列。关系中的元组个数称为关系的基数，属性个数称为关系的度或维数 |
| 超键             | 能唯一区分任意两行数据的属性或属性集。包含超键的多个属性都是超键 |
| 候选键（==键==） | 某一属性（或属性集）的值可唯一地表示每一个元组。<u>候选键本身是超键，但其任何真子集都不再是超键</u>。候选键包含的属性为==主属性== |
| 主键             | 在使用关系来组织数据时，常使用一个候选键作为组织该关系以及唯一性操作的对象，其中被选用的候选键为主键，例如学号。主键包含的属性为==主键属性== |
| 外键             | 对于关系R1、R2，其中某属性\属性集A不是R1的候选键，但是是R2的候选键，则称A是R1的外键 |
| 全键             | 当需要一个关系的全部属性作为该关系的候选键，则称该全部属性组合为全键 |

**关系的种类：**基本关系、查询表（查询结果对应的表）、视图表（虚表）

**关系的性质**：

①列的同质性：每一列中的分量为同一类型，来自同一个域

②列名唯一性：每列要基于不同的属性名，但是不同列的值可以出自同一个域

③元组相异性：关系中任意两个元组不能完全相同

④行序无关性：行的次序无关紧要，可以互换

⑤列序无关性：列的次序无关紧要，可以互换

⑥分量原子性：每一个分量都必须是不可分的数据项

**关系模式：** 关系结构的描述和定义，即二维表的表结构定义。可简记为关系的属性名表。例如学生关系模式可以简记为学生（<u>学号</u>，姓名，性别，年龄，籍贯）。可理解为**表头** 

**关系数据库：** 基于关系模型的数据库。

==关系、关系模型、关系模式和关系数据库的区别与联系：==

**区别：**

- `关系模型`是用表结构表示实体集与实体集之间联系的一种模型；`关系`是属性值域的笛卡儿积中有意义的元组集合，实质上是一张二维表，表的每一行为一个元组，每一列为一个属性；`关系模式`是关系结构的描述和定义，即二维表的表结构定义；`关系数据库`是建立在关系模型之上的关系的集合

**联系：**

- 一个关系只能对应一个关系模式，一个关系模式可对应多个关系
- 关系模式是关系的型，按其型装入数据值后即形成关系
- 关系模式是相对静态的、稳定的，而关系是动态的、随时间变化的
- 一个关系数据库是相关关系的集合，而关系模型的结构是相关关系模式的集合

## 2、关系的完整性约束

**实体完整性**： 组成主键的各属性都不能取空值（任何主键属性都不能为空，==注意属性集不为空不代表属性集中的所有属性都不为空==）。插入和修改元组可能破坏实体完整性规则。

**参照完整性**：如果属性\属性组F是R的外键（R为依赖表），它与S表的主键相对应，则对于R中的每个元组，在F上的取值必须取空值或者等于S中某个元组的主键值。

> **实体完整性优先于参照完整性** 。即外键是主键属性时，不能为空。
>
> <img src="C:/AppData/Roaming/Typora/typora-user-images/image-20220516162456086.png" alt="image-20220516162456086" style="zoom:50%;" />

**用户定义完整性**：针对某一具体关系数据库的约束。包括定义属性是否为空值、定义属性值的唯一性、定义属性的取值范围、定义属性的默认值、定义属性间函数依赖关系等。

---

<img src="https://s2.loli.net/2022/05/16/SB9MQkbiUuwDPaj.png" alt="image-20220516162759988" style="zoom:67%;" />

**关系完整性控制的实现原理**：定义、检查、保证数据完整性

**例子：**

<img src="https://s2.loli.net/2022/05/16/rXFtZ146I9xePCw.png" alt="image-20220516194737598" style="zoom:67%;" />

## 3、关系代数的运算

**常用的关系运算：**并、交、差、笛卡儿积、投影、选择、连接、除运算

**基本的关系运算：**并、差、笛卡儿积、选择、投影，其他的关系运算可以通过这些基本运算来表达（关系依赖） 

<img src="https://s2.loli.net/2022/05/16/1zVE8DkPaXOYuAe.png" alt="image-20220516163214039" style="zoom:67%;" />

### 并 ∪

关系R和S的并由属于R或者属于S的元组（行）组成，并去掉冗余的元组

### 交 ∩

关系R和S的交由即属于R又属于S的元组（行）组成

### 差 -

关系R和S的差由属于R但不属于S的元组（行）组成

👉并交差运算：两个关系必须是相容的同类关系（兼容表），列数相同且属性值取自同一个域

### 积 ×

即笛卡尔积，k元关系R与j元关系S进行笛卡尔积得到j+k元新关系，该关系的元组（行）数为R和S的元组（行）数之积

![image-20220516163515542](https://s2.loli.net/2022/05/16/6Aq4Di3mdcESkLr.png)

### 选择 σ

σ~F~ (R) = {t|(t ∈R) ∧ F(t) = True}。从关系R中选出满足条件表达式F（可简单可复合）的那些==元组==所构成的关系

### 投影 Π

∏~A~ (R) = {t[A] | t ∈ R}。取属性名表A中指定的==列==，**消除重复元组** （当选择的列中不包含键时会出现重复元组）

![image-20220516163855752](https://s2.loli.net/2022/05/16/yiZbTMXzfPdKh7n.png)

### 连接 ⋈

从两个关系的笛卡儿积中选取属性间满足一定条件的元组（==笛卡儿积上进行的选择运算== ）

①等值连接：该特定条件为R关系在A属性（列）上的值与S关系在B属性（列）上的值相等

②自然连接：将结果之中重复的属性（列）去掉的等值连接

👉等值连接与自然连接的区别：①自然连接一定是等值连接，等值连接不一定是自然连接；②等值连接的连接属性不要求是同名属性；③等值连接后不要求去掉同名属性

![image-20220516164224269](https://s2.loli.net/2022/05/16/43KxoqJRZsfLXvj.png)

### 除 ÷

（个人概括？）R ÷ S，先求出R与S的属性集交集，在本例中为CD，∏~C,D~ (S) = {cd, ef}，然后求R的属性集 - CD = AB，将R按AB分组，本例中可以分为三组ab、bc、ed，分别求出这些组的CD集合，本例中为ab组 = {cd, ef, de}，bc组 = {ef}，ed组 = {cd, ef}，可以判断出{cd, ef}包含于ab组和ed组，故R ÷ S = {ab, cd}

![image-20220516165612885](https://s2.loli.net/2022/05/16/s1ezau8YtGgRPyV.png)

## 4、综合的例子

> 基本都是先选择后投影，注意如果要做连接运算的话，可以先做部分选择和投影运算，这样可以降低计算开销
>
> 如果有“所有”这个词，可以考虑除运算

<img src="https://s2.loli.net/2022/05/16/sNoQwLK7nvU3eWu.png" alt="image-20220516185848173" style="zoom:67%;" />

<img src="https://s2.loli.net/2022/05/16/pjqTRbnkX8VPLfy.png" alt="image-20220516185957304" style="zoom:67%;" />

<img src="https://s2.loli.net/2022/05/16/fjmZiRI2uoJaAXb.png" alt="image-20220516190034825" style="zoom:67%;" />

<img src="https://s2.loli.net/2022/05/16/DLAMuWNqnKVo923.png" alt="image-20220516190106486" style="zoom:67%;" />

<img src="https://s2.loli.net/2022/05/16/gQGOdZX5zUB3KTf.png" alt="image-20220516190238200" style="zoom:67%;" />

<img src="https://s2.loli.net/2022/05/16/rjBwDJC1KUzI35h.png" alt="image-20220516190551314" style="zoom:67%;" />

<img src="https://s2.loli.net/2022/05/16/vpOuMmTFUZKsJAL.png" alt="image-20220516191322048" style="zoom:67%;" />

